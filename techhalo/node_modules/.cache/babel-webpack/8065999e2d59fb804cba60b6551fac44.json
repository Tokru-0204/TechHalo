{"ast":null,"code":"import { NavigationEnd } from '@angular/router';\nimport { ChatMessage } from '../../common/ChatMessage';\nimport { Notification } from '../../common/Notification';\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/customer.service\";\nimport * as i2 from \"ngx-toastr\";\nimport * as i3 from \"../../services/session.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"../../services/order.service\";\nimport * as i6 from \"../../services/web-socket.service\";\nimport * as i7 from \"../../services/notification.service\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"ngx-pagination\";\nimport * as i10 from \"../order-detail/order-detail.component\";\nimport * as i11 from \"../../pipes/currency-vietnam.pipe\";\nfunction ProfileHistoryComponent_tr_41_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 16);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"currencyVietnam\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\", 17);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"td\", 18);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"td\", 19);\n    i0.ɵɵelement(18, \"app-order-detail\", 20);\n    i0.ɵɵelementStart(19, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function ProfileHistoryComponent_tr_41_Template_button_click_19_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const item_r1 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.cancel(item_r1.status === 0 ? item_r1.ordersId : -1);\n    });\n    i0.ɵɵtext(20, \" H\\u1EE7y \\u0111\\u01A1n \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r1 = ctx.$implicit;\n    const i_r2 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r2 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 10, item_r1.orderDate, \"HH:mm - dd/MM/yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 13, item_r1.amount));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r1.address);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r1.phone);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r1.paymentMethod == 0 ? \"Khi Nh\\u1EADn H\\u00E0ng\" : \"Chuy\\u1EC3n Kho\\u1EA3n\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r1.status == 0 ? \"Ch\\u1EDD x\\u00E1c nh\\u1EADn\" : item_r1.status == 1 ? \"\\u0110\\u00E3 x\\u00E1c nh\\u1EADn\" : item_r1.status == 2 ? \"\\u0110ang giao h\\u00E0ng\" : item_r1.status == 3 ? \"\\u0110\\u00E3 thanh to\\u00E1n\" : item_r1.status == 4 ? \"\\u0110\\u00E3 giao h\\u00E0ng\" : \"\\u0110\\u00E3 hu\\u1EF7\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"id\", item_r1.ordersId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", item_r1.status !== 0)(\"title\", item_r1.status === 0 ? \"Hu\\u1EF7 \\u0111\\u01A1n\" : \"Kh\\u00F4ng th\\u1EC3 hu\\u1EF7 \\u0111\\u01A1n n\\u00E0y\");\n  }\n}\nconst _c0 = function () {\n  return [\"/home\"];\n};\nconst _c1 = function () {\n  return [\"/profile\"];\n};\nconst _c2 = function (a1) {\n  return {\n    itemsPerPage: 5,\n    currentPage: a1\n  };\n};\nexport let ProfileHistoryComponent = /*#__PURE__*/(() => {\n  class ProfileHistoryComponent {\n    constructor(customerService, toastr, sessionService, router, orderService, webSocketService, notificationService) {\n      this.customerService = customerService;\n      this.toastr = toastr;\n      this.sessionService = sessionService;\n      this.router = router;\n      this.orderService = orderService;\n      this.webSocketService = webSocketService;\n      this.notificationService = notificationService;\n      this.page = 1;\n      this.showEditForm = false;\n    }\n    ngOnInit() {\n      this.webSocketService.openWebSocket();\n      this.router.events.subscribe(evt => {\n        if (!(evt instanceof NavigationEnd)) {\n          return;\n        }\n        window.scrollTo(0, 0);\n      });\n      this.getCustomer();\n      this.getOrder();\n    }\n    ngOnDestroy() {\n      this.webSocketService.closeWebSocket();\n    }\n    getCustomer() {\n      let email = this.sessionService.getUser();\n      this.customerService.getByEmail(email).subscribe(data => {\n        this.customer = data;\n      }, error => {\n        this.toastr.error('Lỗi thông tin', 'Hệ thống');\n        window.location.href = '/';\n      });\n    }\n    getOrder() {\n      let email = this.sessionService.getUser();\n      this.orderService.get(email).subscribe(data => {\n        this.orders = data;\n        this.done = 0;\n        this.orders.forEach(o => {\n          if (o.status === 4) {\n            this.done += 1;\n          }\n        });\n      }, error => {\n        this.toastr.error('Lỗi server', 'Hệ thống');\n      });\n    }\n    cancel(id) {\n      if (id === -1) {\n        return;\n      }\n      Swal.fire({\n        title: 'Bạn có muốn huỷ đơn hàng này?',\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#d33',\n        cancelButtonText: 'Không',\n        confirmButtonText: 'Huỷ'\n      }).then(result => {\n        if (result.isConfirmed) {\n          this.orderService.cancel(id).subscribe(data => {\n            this.getOrder();\n            this.sendMessage(id);\n            this.toastr.success('Huỷ đơn hàng thành công!', 'Hệ thống');\n          }, error => {\n            this.toastr.error('Lỗi server', 'Hệ thống');\n          });\n        }\n      });\n    }\n    sendMessage(id) {\n      let chatMessage = new ChatMessage(this.customer.name, ' đã huỷ một đơn hàng');\n      this.notificationService.post(new Notification(0, this.customer.name + ' đã huỷ một đơn hàng (' + id + ')')).subscribe(data => {\n        this.webSocketService.sendMessage(chatMessage);\n      });\n    }\n    finish() {\n      this.ngOnInit();\n    }\n    navigateToEditProfile() {\n      if (this.customer && this.customer.userId) {\n        this.router.navigate(['/edit-profile', this.customer.userId]);\n      } else {\n        console.error('Không tìm thấy userId!');\n      }\n    }\n  }\n  ProfileHistoryComponent.ɵfac = function ProfileHistoryComponent_Factory(t) {\n    return new (t || ProfileHistoryComponent)(i0.ɵɵdirectiveInject(i1.CustomerService), i0.ɵɵdirectiveInject(i2.ToastrService), i0.ɵɵdirectiveInject(i3.SessionService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.OrderService), i0.ɵɵdirectiveInject(i6.WebSocketService), i0.ɵɵdirectiveInject(i7.NotificationService));\n  };\n  ProfileHistoryComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProfileHistoryComponent,\n    selectors: [[\"app-profile-history\"]],\n    decls: 47,\n    vars: 10,\n    consts: [[1, \"ps-page--my-account\"], [1, \"ps-breadcrumb\"], [1, \"container\"], [1, \"breadcrumb\"], [3, \"routerLink\"], [1, \"ps-section--account\"], [1, \"col-lg-12\"], [1, \"ps-section--account-setting\"], [1, \"ps-section__header\"], [1, \"ps-section__content\"], [1, \"table-responsive\"], [1, \"table\", \"ps-table\", \"ps-table--invoices\"], [4, \"ngFor\", \"ngForOf\"], [1, \"row\"], [1, \"col-lg-12\", 2, \"margin-top\", \"7px\"], [\"previousLabel\", \"\", \"nextLabel\", \"\", 1, \"text-center\", \"my-page\", 3, \"pageChange\"], [2, \"width\", \"15%\"], [2, \"width\", \"9%\"], [2, \"width\", \"10%\"], [2, \"width\", \"8%\", \"text-align\", \"center\"], [2, \"padding-right\", \"10px\", 3, \"id\"], [1, \"btn\", \"btn-danger\", \"btn-sm\", 2, \"cursor\", \"pointer\", 3, \"disabled\", \"title\", \"click\"]],\n    template: function ProfileHistoryComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"main\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"ul\", 3);\n        i0.ɵɵelementStart(4, \"li\");\n        i0.ɵɵelementStart(5, \"a\", 4);\n        i0.ɵɵtext(6, \"Trang ch\\u1EE7\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"li\");\n        i0.ɵɵelementStart(8, \"a\", 4);\n        i0.ɵɵtext(9, \"T\\u00E0i kho\\u1EA3n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"li\");\n        i0.ɵɵtext(11, \"L\\u1ECBch s\\u1EED \\u0111\\u1EB7t h\\u00E0ng\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"section\", 5);\n        i0.ɵɵelementStart(13, \"div\", 2);\n        i0.ɵɵelementStart(14, \"div\", 6);\n        i0.ɵɵelementStart(15, \"div\", 7);\n        i0.ɵɵelementStart(16, \"div\", 8);\n        i0.ɵɵelementStart(17, \"h1\");\n        i0.ɵɵtext(18, \"L\\u1ECBch s\\u1EED \\u0111\\u1EB7t h\\u00E0ng\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"div\", 9);\n        i0.ɵɵelementStart(20, \"div\", 10);\n        i0.ɵɵelementStart(21, \"table\", 11);\n        i0.ɵɵelementStart(22, \"thead\");\n        i0.ɵɵelementStart(23, \"tr\");\n        i0.ɵɵelementStart(24, \"th\");\n        i0.ɵɵtext(25, \"STT\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"th\");\n        i0.ɵɵtext(27, \"Ng\\u00E0y \\u0111\\u1EB7t\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"th\");\n        i0.ɵɵtext(29, \"T\\u1ED5ng ti\\u1EC1n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"th\");\n        i0.ɵɵtext(31, \"\\u0110\\u1ECBa ch\\u1EC9\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"th\");\n        i0.ɵɵtext(33, \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"th\");\n        i0.ɵɵtext(35, \"H\\u00ECnh th\\u1EE9c thanh to\\u00E1n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"th\");\n        i0.ɵɵtext(37, \"Tr\\u1EA1ng th\\u00E1i\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"th\");\n        i0.ɵɵtext(39, \"H\\u00E0nh \\u0111\\u1ED9ng\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"tbody\");\n        i0.ɵɵtemplate(41, ProfileHistoryComponent_tr_41_Template, 21, 15, \"tr\", 12);\n        i0.ɵɵpipe(42, \"paginate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"div\", 13);\n        i0.ɵɵelementStart(44, \"div\", 14);\n        i0.ɵɵelementStart(45, \"ul\");\n        i0.ɵɵelementStart(46, \"pagination-controls\", 15);\n        i0.ɵɵlistener(\"pageChange\", function ProfileHistoryComponent_Template_pagination_controls_pageChange_46_listener($event) {\n          return ctx.page = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(6, _c0));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(7, _c1));\n        i0.ɵɵadvance(33);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(42, 3, ctx.orders, i0.ɵɵpureFunction1(8, _c2, ctx.page)));\n      }\n    },\n    directives: [i4.RouterLinkWithHref, i8.NgForOf, i9.PaginationControlsComponent, i10.OrderDetailComponent],\n    pipes: [i9.PaginatePipe, i8.DatePipe, i11.CurrencyVietnamPipe],\n    styles: [\".ps-breadcrumb[_ngcontent-%COMP%]{background-color:#fff!important;box-shadow:0 6px 10px 0 #0000001a}.ps-section--account-setting[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:12px;box-shadow:0 4px 8px #0000001a}.ps-table[_ngcontent-%COMP%]{width:100%;margin-bottom:20px;border-collapse:collapse}.ps-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .ps-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px;text-align:left;border-bottom:1px solid #e0e0e0;font-size:14px;color:#333}.ps-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#fafafa;color:#555;font-weight:600}.ps-section__header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;color:#333;font-weight:600;margin-bottom:20px}.ps-widget__header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:20px}.ps-image[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%;object-fit:cover;border:3px solid #fff;box-shadow:0 4px 6px #0000001a;transition:transform .3s ease}.ps-image[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.profile-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%], .ps-btn[_ngcontent-%COMP%]{padding:10px 20px;background-color:#19cda9;color:#fff;border-radius:30px;font-size:1rem;border:none;transition:background-color .3s,transform .3s}.profile-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover, .ps-btn[_ngcontent-%COMP%]:hover{background-color:#17b295;transform:translateY(-3px)}.profile-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled, .ps-btn[_ngcontent-%COMP%]:disabled{background-color:#d3d3d3;cursor:not-allowed}.my-page[_ngcontent-%COMP%] .ngx-pagination li{margin:0 5px}.my-page[_ngcontent-%COMP%] .ngx-pagination li a{padding:8px 16px;background-color:#d4d4d44d;border-radius:30px;font-size:14px;transition:background-color .3s}.my-page[_ngcontent-%COMP%] .ngx-pagination li a:hover{background-color:#19cda9;color:#fff}.my-page[_ngcontent-%COMP%] .ngx-pagination{margin:auto!important}.my-page[_ngcontent-%COMP%] .ngx-pagination .current{padding:0}.my-page[_ngcontent-%COMP%] .ngx-pagination .current span{padding:7px 16px!important;background-color:#19cda9!important;border-radius:10%}.ps-form__left[_ngcontent-%COMP%]{text-align:left;margin-bottom:20px}.ps-form__right[_ngcontent-%COMP%]   .form-group--nest[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.ps-form__right[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:70%;padding:12px 20px;font-size:1rem;border-radius:30px;border:1px solid #ddd;box-sizing:border-box;transition:border-color .3s}.ps-form__right[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#19cda9}.ps-form__right[_ngcontent-%COMP%]   .ps-btn[_ngcontent-%COMP%]{padding:12px 20px;background-color:#19cda9;color:#fff;border-radius:30px;font-size:1rem;transition:background-color .3s,transform .3s}.ps-form__right[_ngcontent-%COMP%]   .ps-btn[_ngcontent-%COMP%]:hover{background-color:#17b295;transform:translateY(-3px)}@media (max-width: 1200px){.ps-section--account-setting[_ngcontent-%COMP%]{padding:20px}}@media (max-width: 992px){.ps-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .ps-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px;font-size:12px}.ps-form__right[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:60%}.ps-form__right[_ngcontent-%COMP%]   .ps-btn[_ngcontent-%COMP%]{width:35%}}@media (max-width: 768px){.ps-form__right[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:70%}.ps-form__right[_ngcontent-%COMP%]   .ps-btn[_ngcontent-%COMP%]{width:28%}}@media (max-width: 576px){.ps-page--my-account[_ngcontent-%COMP%]{padding:10px}.ps-table[_ngcontent-%COMP%]{font-size:11px}.ps-form__right[_ngcontent-%COMP%]   .ps-btn[_ngcontent-%COMP%]{width:100%;padding:10px 20px}.ps-form__right[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:100%;padding:10px}}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:5px}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;border-color:#dc3545}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333;border-color:#bd2130}button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}\"]\n  });\n  return ProfileHistoryComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}