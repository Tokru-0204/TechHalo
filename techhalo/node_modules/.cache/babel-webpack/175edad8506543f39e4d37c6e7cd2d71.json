{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services_admin/session.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../../services_admin/customer.service\";\nimport * as i4 from \"ngx-toastr\";\nimport * as i5 from \"../../services_admin/notification.service\";\nimport * as i6 from \"../../services_admin/auth.service\";\nimport * as i7 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i8 from \"@angular/forms\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"../profile/profile.component\";\nconst _c0 = function () {\n  return [\"/admin/order\"];\n};\nfunction HeaderComponent_Admin_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"a\", 37);\n    i0.ɵɵlistener(\"click\", function HeaderComponent_Admin_div_23_Template_a_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const item_r1 = restoredCtx.$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return ctx_r2.readed(item_r1.id);\n    });\n    i0.ɵɵelementStart(2, \"div\", 38);\n    i0.ɵɵelementStart(3, \"div\", 39);\n    i0.ɵɵelement(4, \"i\", 40);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\");\n    i0.ɵɵelementStart(6, \"div\", 41);\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"span\", 42);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r1 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵstyleMap(item_r1.status ? \"\" : \"background-color: rgba(211, 234, 255, 0.295);\");\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(8, _c0));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 5, item_r1.time, \"medium\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r1.message);\n  }\n}\nexport let HeaderComponent_Admin = /*#__PURE__*/(() => {\n  class HeaderComponent_Admin {\n    constructor(sessionService, router, customerService, toastr, notificationService, userService) {\n      this.sessionService = sessionService;\n      this.router = router;\n      this.customerService = customerService;\n      this.toastr = toastr;\n      this.notificationService = notificationService;\n      this.userService = userService;\n      this.chatMessages = [];\n      this.role = 'Loading...'; // Giá trị mặc định ban đầu\n    }\n    ngOnInit() {\n      // Lấy email từ session\n      this.email = this.sessionService.getUser() || 'Unknown User';\n      if (this.email) {\n        this.userService.getRoleByEmail(this.email).subscribe(role => {\n          this.role = role; // Gán vai trò từ JSON trả về\n        }, error => {\n          console.error('Không thể lấy vai trò:', error);\n          this.role = 'Unknown Role'; // Vai trò mặc định nếu có lỗi\n        });\n      }\n      this.openWebSocket();\n      this.getUser();\n      this.getAllNotification();\n    }\n    getUser() {\n      let email = this.sessionService.getUser();\n      this.customerService.getByEmail(email).subscribe(data => {\n        this.user = data;\n        this.name = this.user.name;\n        this.image = this.user.image;\n      }, error => {\n        this.toastr.error('Đã xảy ra lỗi', 'Hệ thống');\n        this.sessionService.signOut();\n        this.router.navigate(['/login']);\n      });\n    }\n    getAllNotification() {\n      this.notificationService.get().subscribe(data => {\n        this.notifications = data;\n      });\n    }\n    getNotificationFalse() {\n      let count = 0;\n      for (const item of this.notifications) {\n        if (!item.status) {\n          count++;\n        }\n      }\n      return count;\n    }\n    readed(id) {\n      this.notificationService.readed(id).subscribe(data => {\n        this.getAllNotification();\n      });\n    }\n    readAll() {\n      for (const i of this.notifications) {\n        this.notificationService.readed(i.id).subscribe(data => {});\n      }\n      this.getAllNotification();\n    }\n    // logOut() {\n    //   this.router.navigate(['/home']);\n    //   // Điều hướng về home\n    //   this.router.navigate(['/home']).then(() => {\n    //     // Reload trang để áp dụng CSS toàn cục\n    //     window.location.reload();\n    //   });\n    // }\n    logOut() {\n      this.sessionService.signOut();\n      window.location.href = '/';\n    }\n    finish() {\n      this.ngOnInit();\n    }\n    openWebSocket() {\n      this.webSocket = new WebSocket('ws://localhost:8080/notification');\n      this.webSocket.onopen = event => {\n        // console.log('Open: ', event);\n      };\n      this.webSocket.onmessage = event => {\n        const chatMessageDto = JSON.parse(event.data);\n        let mess = chatMessageDto;\n        this.toastr.info('Khách hàng ' + mess.user + ' ' + mess.message, 'Hệ thống');\n        this.getAllNotification();\n        this.getNotificationFalse();\n        this.chatMessages.push(chatMessageDto);\n      };\n      this.webSocket.onclose = event => {\n        // console.log('Close: ', event);\n      };\n    }\n    closeWebSocket() {\n      this.webSocket.close();\n    }\n  }\n  HeaderComponent_Admin.ɵfac = function HeaderComponent_Admin_Factory(t) {\n    return new (t || HeaderComponent_Admin)(i0.ɵɵdirectiveInject(i1.SessionService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.CustomerService), i0.ɵɵdirectiveInject(i4.ToastrService), i0.ɵɵdirectiveInject(i5.NotificationService), i0.ɵɵdirectiveInject(i6.AuthService));\n  };\n  HeaderComponent_Admin.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HeaderComponent_Admin,\n    selectors: [[\"app-header-admin\"]],\n    decls: 44,\n    vars: 5,\n    consts: [[1, \"navbar\", \"navbar-expand\", \"navbar-light\", \"bg-white\", \"topbar\", \"mb-4\", \"static-top\", \"shadow\"], [\"id\", \"sidebarToggleTop\", 1, \"btn\", \"btn-link\", \"d-md-none\", \"rounded-circle\", \"mr-3\"], [1, \"fa\", \"fa-bars\"], [1, \"navbar-nav\", \"ml-auto\"], [1, \"nav-item\", \"dropdown\", \"no-arrow\", \"d-sm-none\"], [\"href\", \"#\", \"id\", \"searchDropdown\", \"role\", \"button\", \"data-toggle\", \"dropdown\", \"aria-haspopup\", \"true\", \"aria-expanded\", \"false\", 1, \"nav-link\", \"dropdown-toggle\"], [1, \"fas\", \"fa-search\", \"fa-fw\"], [\"aria-labelledby\", \"searchDropdown\", 1, \"dropdown-menu\", \"dropdown-menu-right\", \"p-3\", \"shadow\", \"animated--grow-in\"], [1, \"form-inline\", \"mr-auto\", \"w-100\", \"navbar-search\"], [1, \"input-group\"], [\"type\", \"text\", \"placeholder\", \"Search for...\", \"aria-label\", \"Search\", \"aria-describedby\", \"basic-addon2\", 1, \"form-control\", \"bg-light\", \"border-0\", \"small\"], [1, \"input-group-append\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\"], [1, \"fas\", \"fa-search\", \"fa-sm\"], [1, \"nav-item\", \"dropdown\", \"no-arrow\", \"mx-1\"], [\"href\", \"#\", \"id\", \"alertsDropdown\", \"role\", \"button\", \"data-toggle\", \"dropdown\", \"aria-haspopup\", \"true\", \"aria-expanded\", \"false\", 1, \"nav-link\", \"dropdown-toggle\"], [1, \"fas\", \"fa-bell\", \"fa-fw\"], [1, \"badge\", \"badge-danger\", \"badge-counter\"], [\"aria-labelledby\", \"alertsDropdown\", 1, \"dropdown-list\", \"dropdown-menu\", \"dropdown-menu-right\", \"shadow\", \"animated--grow-in\"], [1, \"dropdown-header\", \"m-0\"], [2, \"max-height\", \"60vh\", \"overflow\", \"overlay\"], [4, \"ngFor\", \"ngForOf\"], [1, \"dropdown-item\", \"text-center\", \"small\", \"text-gray-500\", 2, \"cursor\", \"pointer\", 3, \"click\"], [\"href\", \"https://mail.google.com/\", \"target\", \"blank\", 1, \"nav-link\", \"dropdown-toggle\"], [1, \"fas\", \"fa-envelope\", \"fa-fw\"], [1, \"topbar-divider\", \"d-none\", \"d-sm-block\"], [1, \"nav-item\", \"dropdown\", \"no-arrow\"], [\"id\", \"userDropdown\", \"role\", \"button\", \"data-toggle\", \"dropdown\", \"aria-haspopup\", \"true\", \"aria-expanded\", \"false\", 1, \"nav-link\", \"dropdown-toggle\", \"d-flex\", \"align-items-center\"], [1, \"text-right\", \"mr-3\"], [1, \"d-block\", \"text-gray-600\", \"small\"], [1, \"d-block\", \"text-gray-500\", \"small\"], [\"alt\", \"User Avatar\", 1, \"img-profile\", \"rounded-circle\", 2, \"object-fit\", \"cover\", \"width\", \"40px\", \"height\", \"40px\", 3, \"src\"], [\"aria-labelledby\", \"userDropdown\", 1, \"dropdown-menu\", \"dropdown-menu-right\", \"shadow\", \"animated--grow-in\"], [3, \"editFinish\"], [1, \"dropdown-divider\"], [\"data-toggle\", \"modal\", \"data-target\", \"#logoutModal\", 1, \"dropdown-item\", 2, \"cursor\", \"pointer\", 3, \"click\"], [1, \"fas\", \"fa-sign-out-alt\", \"fa-sm\", \"fa-fw\", \"mr-2\", \"text-gray-400\"], [1, \"dropdown-item\", \"d-flex\", \"align-items-center\", 3, \"routerLink\", \"click\"], [1, \"mr-3\"], [1, \"icon-circle\", \"bg-primary\"], [1, \"fas\", \"fa-file-alt\", \"text-white\"], [1, \"small\", \"text-gray-500\"], [1, \"font-weight-bold\"]],\n    template: function HeaderComponent_Admin_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"nav\", 0);\n        i0.ɵɵelementStart(1, \"button\", 1);\n        i0.ɵɵelement(2, \"i\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"ul\", 3);\n        i0.ɵɵelementStart(4, \"li\", 4);\n        i0.ɵɵelementStart(5, \"a\", 5);\n        i0.ɵɵelement(6, \"i\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 7);\n        i0.ɵɵelementStart(8, \"form\", 8);\n        i0.ɵɵelementStart(9, \"div\", 9);\n        i0.ɵɵelement(10, \"input\", 10);\n        i0.ɵɵelementStart(11, \"div\", 11);\n        i0.ɵɵelementStart(12, \"button\", 12);\n        i0.ɵɵelement(13, \"i\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"li\", 14);\n        i0.ɵɵelementStart(15, \"a\", 15);\n        i0.ɵɵelement(16, \"i\", 16);\n        i0.ɵɵelementStart(17, \"span\", 17);\n        i0.ɵɵtext(18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"div\", 18);\n        i0.ɵɵelementStart(20, \"h6\", 19);\n        i0.ɵɵtext(21, \" Th\\u00F4ng b\\u00E1o \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"div\", 20);\n        i0.ɵɵtemplate(23, HeaderComponent_Admin_div_23_Template, 11, 9, \"div\", 21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"a\", 22);\n        i0.ɵɵlistener(\"click\", function HeaderComponent_Admin_Template_a_click_24_listener() {\n          return ctx.readAll();\n        });\n        i0.ɵɵtext(25, \"\\u0110\\u00E1nh d\\u1EA5u \\u0111\\u00E3 \\u0111\\u1ECDc t\\u1EA5t c\\u1EA3\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"li\", 14);\n        i0.ɵɵelementStart(27, \"a\", 23);\n        i0.ɵɵelement(28, \"i\", 24);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(29, \"div\", 25);\n        i0.ɵɵelementStart(30, \"li\", 26);\n        i0.ɵɵelementStart(31, \"a\", 27);\n        i0.ɵɵelementStart(32, \"div\", 28);\n        i0.ɵɵelementStart(33, \"span\", 29);\n        i0.ɵɵtext(34);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"span\", 30);\n        i0.ɵɵtext(36);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(37, \"img\", 31);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"div\", 32);\n        i0.ɵɵelementStart(39, \"app-profile\", 33);\n        i0.ɵɵlistener(\"editFinish\", function HeaderComponent_Admin_Template_app_profile_editFinish_39_listener() {\n          return ctx.finish();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(40, \"div\", 34);\n        i0.ɵɵelementStart(41, \"a\", 35);\n        i0.ɵɵlistener(\"click\", function HeaderComponent_Admin_Template_a_click_41_listener() {\n          return ctx.logOut();\n        });\n        i0.ɵɵelement(42, \"i\", 36);\n        i0.ɵɵtext(43, \" Logout \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(18);\n        i0.ɵɵtextInterpolate(ctx.getNotificationFalse());\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.notifications);\n        i0.ɵɵadvance(11);\n        i0.ɵɵtextInterpolate(ctx.name || \"Ng\\u01B0\\u1EDDi d\\u00F9ng\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" Vai tr\\u00F2: \", ctx.role === \"ROLE_ADMIN\" ? \"Qu\\u1EA3n tr\\u1ECB\" : ctx.role === \"ROLE_EMPLOYEE\" ? \"Nh\\u00E2n vi\\u00EAn\" : \"Vai tr\\u00F2 kh\\u00F4ng x\\u00E1c \\u0111\\u1ECBnh\", \" \");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"src\", ctx.image || \"assets/default-avatar.png\", i0.ɵɵsanitizeUrl);\n      }\n    },\n    directives: [i7.NgbNavbar, i8.ɵNgNoValidate, i8.NgControlStatusGroup, i8.NgForm, i9.NgForOf, i10.ProfileComponent_Admin, i2.RouterLinkWithHref],\n    pipes: [i9.DatePipe],\n    styles: [\".text-gray-600[_ngcontent-%COMP%]{color:#6f7579;font-size:1.2rem;font-weight:700;margin-bottom:-5px}.text-gray-500[_ngcontent-%COMP%]{color:#818486;font-size:1rem}\"]\n  });\n  return HeaderComponent_Admin;\n})();","map":null,"metadata":{},"sourceType":"module"}