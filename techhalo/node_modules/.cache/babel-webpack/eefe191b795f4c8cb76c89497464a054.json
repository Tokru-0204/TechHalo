{"ast":null,"code":"import { NavigationEnd } from '@angular/router';\nimport { Cart } from '../../common/Cart';\nimport Swal from 'sweetalert2';\nimport { CartDetail } from '../../common/CartDetail';\nimport { Product } from '../../common/Product';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"ngx-toastr\";\nimport * as i2 from \"../../services/cart.service\";\nimport * as i3 from \"../../services/favorites.service\";\nimport * as i4 from \"../../services/session.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/forms\";\nimport * as i8 from \"ngx-pagination\";\nimport * as i9 from \"../../pipes/currency-vietnam.pipe\";\nfunction FavoriteComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵelementStart(1, \"h2\", 22);\n    i0.ɵɵtext(2, \"Kh\\u00F4ng c\\u00F3 s\\u1EA3n ph\\u1EA9m n\\u00E0o trong danh s\\u00E1ch y\\u00EAu th\\u00EDch c\\u1EE7a b\\u1EA1n\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function (a0) {\n  return [a0];\n};\nfunction FavoriteComponent_div_19_tr_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 29);\n    i0.ɵɵelementStart(4, \"div\", 30);\n    i0.ɵɵelementStart(5, \"div\", 31);\n    i0.ɵɵelementStart(6, \"a\", 4);\n    i0.ɵɵelement(7, \"img\", 32);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\", 29);\n    i0.ɵɵelementStart(9, \"div\", 30);\n    i0.ɵɵelementStart(10, \"div\", 33);\n    i0.ɵɵelementStart(11, \"a\", 4);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\");\n    i0.ɵɵtext(14, \"Danh M\\u1EE5c:\");\n    i0.ɵɵelementStart(15, \"strong\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"td\", 34);\n    i0.ɵɵtext(18);\n    i0.ɵɵpipe(19, \"currencyVietnam\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"td\", 35);\n    i0.ɵɵelementStart(21, \"span\", 36);\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"td\", 37);\n    i0.ɵɵelementStart(24, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function FavoriteComponent_div_19_tr_19_Template_button_click_24_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const item_r3 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return ctx_r5.addCart(item_r3.product.productId, item_r3.product.price * (1 - item_r3.product.discount / 100));\n    });\n    i0.ɵɵtext(25, \"Th\\u00EAm Gi\\u1ECF H\\u00E0ng\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"td\", 39);\n    i0.ɵɵelementStart(27, \"a\", 40);\n    i0.ɵɵlistener(\"click\", function FavoriteComponent_div_19_tr_19_Template_a_click_27_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const item_r3 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return ctx_r7.delete(item_r3.favoriteId, item_r3.product.name);\n    });\n    i0.ɵɵelement(28, \"i\", 41);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    const i_r4 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r4 + 1);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(11, _c0, \"/product-detail/\" + item_r3.product.productId));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", item_r3.product.image, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(13, _c0, \"/product-detail/\" + item_r3.product.productId));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(item_r3.product.name);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", item_r3.product.category.categoryName, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(19, 9, item_r3.product.price * (1 - item_r3.product.discount / 100)), \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(item_r3.product.quantity > 0 ? \"C\\u00F2n h\\u00E0ng\" : \"H\\u1EBFt h\\u00E0ng\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", item_r3.product.quantity < 0);\n  }\n}\nconst _c1 = function (a1) {\n  return {\n    itemsPerPage: 5,\n    currentPage: a1\n  };\n};\nfunction FavoriteComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵelementStart(1, \"table\", 24);\n    i0.ɵɵelementStart(2, \"thead\");\n    i0.ɵɵelementStart(3, \"tr\");\n    i0.ɵɵelementStart(4, \"th\");\n    i0.ɵɵtext(5, \"#\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"S\\u1EA3n ph\\u1EA9m\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"T\\u00EAn\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Gi\\u00E1\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Tr\\u1EA1ng th\\u00E1i\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Th\\u00EAm gi\\u1ECF h\\u00E0ng\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"H\\u00E0nh \\u0111\\u1ED9ng\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"tbody\");\n    i0.ɵɵtemplate(19, FavoriteComponent_div_19_tr_19_Template, 29, 15, \"tr\", 25);\n    i0.ɵɵpipe(20, \"paginate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"div\", 26);\n    i0.ɵɵelementStart(22, \"div\", 27);\n    i0.ɵɵelementStart(23, \"ul\");\n    i0.ɵɵelementStart(24, \"pagination-controls\", 28);\n    i0.ɵɵlistener(\"pageChange\", function FavoriteComponent_div_19_Template_pagination_controls_pageChange_24_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.page = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(19);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(20, 1, ctx_r1.favorites, i0.ɵɵpureFunction1(4, _c1, ctx_r1.page)));\n  }\n}\nconst _c2 = function () {\n  return [\"/home\"];\n};\nconst _c3 = function () {\n  return [\"/all-product\"];\n};\nexport let FavoriteComponent = /*#__PURE__*/(() => {\n  class FavoriteComponent {\n    constructor(toastr, cartService, favoriteService, sessionService, router) {\n      this.toastr = toastr;\n      this.cartService = cartService;\n      this.favoriteService = favoriteService;\n      this.sessionService = sessionService;\n      this.router = router;\n      this.page = 1;\n    }\n    ngOnInit() {\n      this.router.events.subscribe(evt => {\n        if (!(evt instanceof NavigationEnd)) {\n          return;\n        }\n        window.scrollTo(0, 0);\n      });\n      this.getAll();\n    }\n    getAll() {\n      let email = this.sessionService.getUser();\n      this.favoriteService.getByEmail(email).subscribe(data => {\n        this.favorites = data;\n        this.favoriteService.setLength(this.favorites.length);\n        this.favorites.forEach(item => {\n          let name = item.product.name.trim();\n          // Tìm dấu '/' trong tên sản phẩm\n          let firstSlashIndex = name.indexOf('/');\n          // Nếu tìm thấy dấu '/' trong tên sản phẩm\n          if (firstSlashIndex !== -1) {\n            // Lấy phần trước dấu '/'\n            let normalPart = name.substring(0, firstSlashIndex).trim();\n            // Tìm dấu cách cuối cùng trong phần normalPart\n            const lastSpaceIndex = normalPart.lastIndexOf(' ');\n            // Cập nhật lại phần normalPart sau khi tìm dấu cách cuối cùng\n            normalPart = name.substring(0, lastSpaceIndex).trim();\n            // Phần styledPart là phần còn lại sau dấu cách cuối cùng\n            let styledPart = name.substring(lastSpaceIndex).trim();\n            // Cập nhật lại tên sản phẩm\n            item.product.name = normalPart;\n            item.product.styledPart = styledPart;\n          } else {\n            // Nếu không có dấu '/', chỉ có một phần normalPart\n            item.product.name = name;\n            item.product.styledPart = '';\n          }\n        });\n      }, error => {\n        this.toastr.error('Lỗi server', 'Hệ thống');\n      });\n    }\n    delete(id, name) {\n      Swal.fire({\n        title: 'Bạn muốn xoá sản phẩm ' + name + ' ra khỏi danh sách yêu thích ?',\n        icon: 'info',\n        showCancelButton: true,\n        confirmButtonText: 'Xoá',\n        cancelButtonText: 'Không'\n      }).then(result => {\n        if (result.isConfirmed) {\n          this.favoriteService.delete(id).subscribe(data => {\n            this.toastr.info('Đã xoá ra khỏi danh sách yêu thích!', 'Hệ thống');\n            this.ngOnInit();\n          }, error => {\n            this.toastr.error('Lỗi', 'Hệ thống');\n            this.ngOnInit();\n          });\n        }\n      });\n    }\n    addCart(productId, price) {\n      let email = this.sessionService.getUser();\n      if (email == null) {\n        this.router.navigate(['/sign-form']);\n        this.toastr.info('Hãy đăng nhập để sử dụng dịch vụ của chúng tôi', 'Hệ thống');\n        return;\n      }\n      this.cartService.getCart(email).subscribe(data => {\n        this.cart = data;\n        this.cartDetail = new CartDetail(0, 1, price, new Product(productId), new Cart(this.cart.cartId));\n        this.cartService.postDetail(this.cartDetail).subscribe(data => {\n          this.toastr.success('Thêm vào giỏ hàng thành công!', 'Hệ thống!');\n          this.cartService.getAllDetail(this.cart.cartId).subscribe(data => {\n            this.cartDetails = data;\n            this.cartService.setLength(this.cartDetails.length);\n          });\n        }, error => {\n          this.toastr.error('Sản phẩm này có thể đã hết hàng!', 'Hệ thống');\n          this.router.navigate(['/home']);\n          window.location.href = \"/\";\n        });\n      });\n    }\n  }\n  FavoriteComponent.ɵfac = function FavoriteComponent_Factory(t) {\n    return new (t || FavoriteComponent)(i0.ɵɵdirectiveInject(i1.ToastrService), i0.ɵɵdirectiveInject(i2.CartService), i0.ɵɵdirectiveInject(i3.FavoritesService), i0.ɵɵdirectiveInject(i4.SessionService), i0.ɵɵdirectiveInject(i5.Router));\n  };\n  FavoriteComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FavoriteComponent,\n    selectors: [[\"app-favorite\"]],\n    decls: 36,\n    vars: 6,\n    consts: [[1, \"ps-page--simple\"], [1, \"ps-breadcrumb\"], [1, \"ps-container\"], [1, \"breadcrumb\"], [3, \"routerLink\"], [1, \"ps-section--shopping\", \"ps-whishlist\"], [1, \"container\"], [1, \"ps-section__header\"], [\"class\", \"col-lg-12 text-center m-5\", 4, \"ngIf\"], [1, \"ps-section__content\"], [\"class\", \"table-responsive\", 4, \"ngIf\"], [1, \"ps-newsletter\"], [1, \"ps-form--newsletter\"], [1, \"row\"], [1, \"col-xl-5\", \"col-lg-12\", \"col-md-12\", \"col-sm-12\", \"col-12\"], [1, \"ps-form__left\"], [1, \"col-xl-7\", \"col-lg-12\", \"col-md-12\", \"col-sm-12\", \"col-12\"], [1, \"ps-form__right\"], [1, \"form-group--nest\"], [\"type\", \"email\", \"placeholder\", \"\\u0110\\u1ECBa ch\\u1EC9 Email\", 1, \"form-control\"], [1, \"ps-btn\"], [1, \"col-lg-12\", \"text-center\", \"m-5\"], [2, \"color\", \"#19cda9\"], [1, \"table-responsive\"], [1, \"table\", \"ps-table--whishlist\", \"ps-table--responsive\"], [4, \"ngFor\", \"ngForOf\"], [1, \"row\", 2, \"padding-top\", \"50px\"], [1, \"col-lg-12\"], [\"previousLabel\", \"\", \"nextLabel\", \"\", 1, \"text-center\", \"my-page\", 3, \"pageChange\"], [\"data-label\", \"Product\", 2, \"text-align\", \"center\"], [1, \"ps-product--cart\"], [1, \"ps-product__thumbnail\"], [\"alt\", \"\", 3, \"src\"], [1, \"ps-product__content\"], [\"data-label\", \"Price\", 1, \"price\", 2, \"text-align\", \"center\"], [\"data-label\", \"Status\", 2, \"text-align\", \"center\"], [1, \"ps-tag\", \"ps-tag--in-stock\"], [\"data-label\", \"action\", 2, \"text-align\", \"center\"], [1, \"ps-btn\", 3, \"disabled\", \"click\"], [\"data-label\", \"Remove\", 2, \"text-align\", \"center\"], [\"href\", \"javascript:void(0);\", 3, \"click\"], [1, \"icon-cross\"]],\n    template: function FavoriteComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"ul\", 3);\n        i0.ɵɵelementStart(4, \"li\");\n        i0.ɵɵelementStart(5, \"a\", 4);\n        i0.ɵɵtext(6, \"Trang ch\\u1EE7\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"li\");\n        i0.ɵɵelementStart(8, \"a\", 4);\n        i0.ɵɵtext(9, \"C\\u1EEDa h\\u00E0ng\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"li\");\n        i0.ɵɵtext(11, \"Danh s\\u00E1ch y\\u00EAu th\\u00EDch\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\", 5);\n        i0.ɵɵelementStart(13, \"div\", 6);\n        i0.ɵɵelementStart(14, \"div\", 7);\n        i0.ɵɵelementStart(15, \"h1\");\n        i0.ɵɵtext(16, \"Danh s\\u00E1ch y\\u00EAu th\\u00EDch\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(17, FavoriteComponent_div_17_Template, 3, 0, \"div\", 8);\n        i0.ɵɵelementStart(18, \"div\", 9);\n        i0.ɵɵtemplate(19, FavoriteComponent_div_19_Template, 25, 6, \"div\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\", 11);\n        i0.ɵɵelementStart(21, \"div\", 6);\n        i0.ɵɵelementStart(22, \"form\", 12);\n        i0.ɵɵelementStart(23, \"div\", 13);\n        i0.ɵɵelementStart(24, \"div\", 14);\n        i0.ɵɵelementStart(25, \"div\", 15);\n        i0.ɵɵelementStart(26, \"h3\");\n        i0.ɵɵtext(27, \"B\\u1EA3n tin\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"p\");\n        i0.ɵɵtext(29, \"\\u0110\\u0103ng k\\u00FD \\u0111\\u1EC3 nh\\u1EADn th\\u00F4ng tin v\\u1EC1 s\\u1EA3n ph\\u1EA9m v\\u00E0 phi\\u1EBFu gi\\u1EA3m gi\\u00E1\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"div\", 16);\n        i0.ɵɵelementStart(31, \"div\", 17);\n        i0.ɵɵelementStart(32, \"div\", 18);\n        i0.ɵɵelement(33, \"input\", 19);\n        i0.ɵɵelementStart(34, \"button\", 20);\n        i0.ɵɵtext(35, \"G\\u1EEDi\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(4, _c2));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(5, _c3));\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngIf\", ctx.favorites.length < 1);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.favorites.length > 0);\n      }\n    },\n    directives: [i5.RouterLinkWithHref, i6.NgIf, i7.ɵNgNoValidate, i7.NgControlStatusGroup, i7.NgForm, i6.NgForOf, i8.PaginationControlsComponent],\n    pipes: [i8.PaginatePipe, i9.CurrencyVietnamPipe],\n    styles: [\".ps-breadcrumb[_ngcontent-%COMP%]{background-color:#fff!important;box-shadow:0 6px 10px 0 #0000001a}.my-page[_ngcontent-%COMP%] .ngx-pagination .current{padding:0}.my-page[_ngcontent-%COMP%] .ngx-pagination .current span{padding:7px 16px!important;background-color:#19cda9!important;border-radius:10%}.my-page[_ngcontent-%COMP%] .ngx-pagination li{margin:4px}.my-page[_ngcontent-%COMP%] .ngx-pagination li a{padding:7px 16px!important;background-color:hsla(0,0%,83%,.233);border-radius:10%}.ps-section__header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:-50px;margin-bottom:-50px}\"]\n  });\n  return FavoriteComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}